<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="559" height="378"><defs/><g><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="559" height="378"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="147.31262961588868" y="22.6179738" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">PKI-AUTH: Authorization</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 138.5411037070508 88.511670804 L 138.5411037070508 378.02173544400006" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 400.017497504707 88.511670804 L 400.017497504707 378.02173544400006" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 102.02243650034379 47.799317964000004 L 175.05977091375786 47.799317964000004 L 175.05977091375786 88.511670804 L 102.02243650034379 88.511670804 L 102.02243650034379 47.799317964000004 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="118.38277088234378" y="73.43302160400002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 360.4238295350605 47.799317964000004 L 439.61116547435347 47.799317964000004 L 439.61116547435347 88.511670804 L 360.4238295350605 88.511670804 L 360.4238295350605 47.799317964000004 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="376.78416391706054" y="73.43302160400002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">server</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 7.5393246000000005 118.668969204 L 255.97209853410163 118.668969204 L 269.54288281410163 132.239753484 L 269.54288281410163 153.34986236400002 L 7.5393246000000005 153.34986236400002 L 7.5393246000000005 118.668969204 M 255.97209853410163 118.668969204 L 255.97209853410163 132.239753484 L 269.54288281410163 132.239753484" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.649433480000027" y="139.77907808400002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client gets JWT once loggedIn</text></g><g><g><rect fill="white" stroke="none" x="156.3841719270508" y="175.967836164" width="207.09026040941407" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="156.3841719270508" y="191.046485364" width="225.79025735765626" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="158.6459693070508" y="189.538620444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Request protectedResource</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="158.6459693070508" y="204.617269644" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Headers: ['x-auth-token': JWT]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 138.5411037070508 210.64872932400002 L 397.50438930470705 210.64872932400002" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(400.017497504707,210.64872932400002) translate(-400.017497504707,-210.64872932400002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 387.451956504707 204.36595882400002 L 400.017497504707 210.64872932400002 L 387.451956504707 216.931499824 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 248.3490542741211 233.266703124 L 538.1151564552929 233.266703124 L 551.6859407352929 246.837487404 L 551.6859407352929 283.026245484 L 248.3490542741211 283.026245484 L 248.3490542741211 233.266703124 M 538.1151564552929 233.266703124 L 538.1151564552929 246.837487404 L 551.6859407352929 246.837487404" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="269.4591631541211" y="254.37681200400004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Extract 'x-auth-token' header</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="269.4591631541211" y="269.455461204" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Verify JWT; verify(JWT, jwtSecret)</text></g><g><g><rect fill="white" stroke="none" x="216.54250475175783" y="305.64421928400003" width="105.47359170824218" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="218.80430213175782" y="319.2150035640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Allows access</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 400.017497504707 325.24646324400004 L 141.0542119070508 325.24646324400004" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="6.03145968"/><g transform="translate(138.5411037070508,325.24646324400004) translate(-138.5411037070508,-325.24646324400004)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 151.1066447070508 318.963692744 L 138.5411037070508 325.24646324400004 L 151.1066447070508 331.52923374400007 Z"/></g></g></g><g/><g/></g></svg>